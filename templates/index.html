<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="icon" type="image" href="https://images.all-free-download.com/images/graphicthumb/crystal_style_earth_vector_288763.jpg"><title>Global Refugee Dashboard</title>
  <link rel="stylesheet" href='../static/css/main.css'>
  <link rel="stylesheet" href='../static/css/d3Style.css'>
  <link rel="stylesheet" href="https://bootswatch.com/4/solar/bootstrap.min.css">
</head>

<body>
  <div class="container">
    <div class="row">
      <div class="col-md-12 jumbotron text-center">
        <h1>Global Refugee Dashboard</h1>
        <h3>By the end of 2017, 68.5 million individuals were forcibly displaced worldwide as a result of persecution, conflict, violence, or human rights violations. </h3><br>
        <h3>That's equivalent to the population of <big>France</big>.</h3>
        <h3><big>1</big> in every <big>100</big> people globally is either an asylum-seeker, internally displaced or a refugee.</h3>
      </div>
    </div>
  </div>
  <br>
  <br>
  <div class="container">
    <div class="row">
      <div class="col-md-12">
        <iframe  width="100%" height=800px src="https://arentaylor.github.io/Week17-Visualizing-Data-with-Leaflet/" frameborder="0" scrolling="auto" allowfullscreen>
        </iframe>
      </div>
    </div>
  </div>
<br>
<br>
<br>
<br>
<!-- Load d3.js -->
<script src="https://d3js.org/d3.v4.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/5.5.0/d3.js"></script>
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
<!-- <script src='../static/js/app.js'></script> -->

<!-- Create a div where the graph will take place -->
<center>
  <div class="container">
      <div class="row">
        <div class="col-md-12">
          <div id="stackedbar"></div>
        </div>
      </div>
  </div>
</center>
<br>
<br>
<center>
  <div class="container">
    <div class="row">
      <div class="col-md-12">
        <style>
          .axis .domain {
            display: none;
          }
        </style>
        <svg width="960" height="500"></svg>
        <script src="https://d3js.org/d3.v4.min.js"></script>
        <script>
      var svg = d3.select("svg"),
        margin = {
          top: 20,
          right: 20,
          bottom: 30,
          left: 40
        },
        width = +svg.attr("width") - margin.left - margin.right,
        height = +svg.attr("height") - margin.top - margin.bottom,
        g = svg.append("g").attr("transform", "translate(" + margin.left + "," + margin.top + ")");

      var x = d3.scaleBand()
        .rangeRound([0, width])
        .paddingInner(0.05)
        .align(0.1);

      var y = d3.scaleLinear()
        .rangeRound([height, 0]);

      var z = d3.scaleOrdinal()
        .range(["#F0704A", "#E0F3A1", "#4288B5"]);

      var data = [
      {
        "Female Adults": 6349588,
        "Male Adults": 6413333,
        "Children": 14186429,
        "Year": 2017
      },
      {
        "Female Adults": 5552531,
        "Male Adults": 5658801,
        "Children": 12653104,
        "Year": 2016
      },
      {
        "Female Adults": 5097886,
        "Male Adults": 5185815,
        "Children": 10898751,
        "Year": 2015
      },
      {
        "Female Adults": 4027282,
        "Male Adults": 4014695,
        "Children": 8689436,
        "Year": 2014
      },
     {
        "Female Adults": 3673810,
        "Male Adults": 3622917,
        "Children": 7926975,
        "Year": 2013
      },
      {
        "Female Adults": 3016959,
        "Male Adults": 3343988,
        "Children": 6057060,
        "Year": 2012
      },
    {
        "Female Adults": 3290252,
        "Male Adults": 3454794,
        "Children": 6215473,
        "Year": 2011
      },
      {
        "Female Adults": 3229429,
        "Male Adults": 3447339,
        "Children": 6098292,
        "Year": 2010
      },
     {
        "Female Adults": 3325017,
        "Male Adults": 3631844,
        "Children": 5608817,
        "Year": 2009
      },
      {
        "Female Adults": 2622991,
        "Male Adults": 2693206,
        "Children": 4867638,
        "Year": 2008
      },
      {
        "Female Adults": 1572049,
        "Male Adults": 1681066,
        "Children": 2633921,
        "Year": 2007
      },
      {
        "Female Adults": 1543357,
        "Male Adults": 1658163,
        "Children": 2507348,
        "Year": 2005
      },
      {
        "Female Adults": 1853007,
        "Male Adults": 1902464,
        "Children": 3340355,
        "Year": 2004
      },
      {
        "Female Adults": 1649484,
        "Male Adults": 1886062,
        "Children": 2668937,
        "Year": 2003
      },
      {
        "Female Adults": 1397665,
        "Male Adults": 1393289,
        "Children": 2006160,
        "Year": 2002
      },
      {
        "Female Adults": 1606499,
        "Male Adults": 1462881,
        "Children": 2650838,
        "Year": 2001
      }
      
    ];

      // fix pre-processing
      var keys = [];
      for (key in data[0]){
        if (key != "Year")
          keys.push(key);
      }
      data.forEach(function(d){
        d.total = 0;
        keys.forEach(function(k){
          d.total += d[k];
        })
      });

      data.sort(function(a, b) {
        return b.total - a.total;
      });
      x.domain(data.map(function(d) {
        return d.Year;
      }));
      y.domain([0, d3.max(data, function(d) {
        return d.total;
      })]).nice();
      z.domain(keys);

      g.append("g")
        .selectAll("g")
        .data(d3.stack().keys(keys)(data))
        .enter().append("g")
        .attr("fill", function(d) {
          return z(d.key);
        })
        .selectAll("rect")
        .data(function(d) {
          return d;
        })
        .enter().append("rect")
        .attr("x", function(d) {
          return x(d.data.Year);
        })
        .attr("y", function(d) {
          return y(d[1]);
        })
        .attr("height", function(d) {
          return y(d[0]) - y(d[1]);
        })
        .attr("width", x.bandwidth());

      g.append("g")
        .attr("class", "axis")
        .attr("transform", "translate(0," + height + ")")
        .call(d3.axisBottom(x));

      g.append("g")
        .attr("class", "axis")
        .call(d3.axisLeft(y).ticks(null, "s"))
        .append("text")
        .attr("x", 2)
        .attr("y", y(y.ticks().pop()) + 0.5)
        .attr("dy", "0.32em")
        .attr("fill", "#000")
        .attr("font-weight", "bold")
        .attr("text-anchor", "start")
        .text("Population");

      var legend = g.append("g")
        .attr("font-family", "sans-serif")
        .attr("font-size", 10)
        .attr("text-anchor", "end")
        .selectAll("g")
        .data(keys.slice().reverse())
        .enter().append("g")
        .attr("transform", function(d, i) {
          return "translate(0," + i * 20 + ")";
        });

      legend.append("rect")
        .attr("x", width - 19)
        .attr("width", 19)
        .attr("height", 19)
        .attr("fill", z);

      legend.append("text")
        .attr("x", width - 24)
        .attr("y", 9.5)
        .attr("dy", "0.32em")
        .text(function(d) {
          return d;
        });
        </script>
      </div>
    </div>
  </div>
</center>
<br>
<br>
<br>
<br>
</body>
</html>
